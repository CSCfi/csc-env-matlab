- name: "Install matlab base container"
  hosts:
    - "group_localhost"
    - "group_puhti"
  become: false
  vars:
    container: "ubuntu_22.04.sif"

  tasks:
    - name: "Create a matlab application directory"
      ansible.builtin.file:
        path: "{{ appl_dir }}/{{ item }}"
        state: "directory"
        mode: "ug=rwx,o=rx,g+s"
        group: "{{ group }}"
      loop:
        - "matlab"
        - "matlab/container"

    - name: "Copy the container"
      ansible.builtin.copy:
        src: "{{ playbook_dir }}/build/{{ container }}"
        dest: "{{ appl_dir }}/matlab/container/{{ container }}"
        mode: "ug=rwx,o=rx"
        group: "{{ group }}"
        checksum: "sha256:f093b0152c01c38991451e09355b2d4d216676a731c30bf7c1b4d828af4356c3"
